<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />

    <title>My first BootstrapVue app</title>

    <!-- Required Stylesheets -->
    <link
      type="text/css"
      rel="stylesheet"
      href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css"
    />
    <link
      type="text/css"
      rel="stylesheet"
      href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"
    />
  </head>

  <body>
    <div id="app">
      <b-container>
        <form style="margin-bottom: 60px;" @submit="submitForm">
          <div class="form-group">
            <input
              type="user_id"
              class="form-control"
              id="user_id"
              placeholder="User ID"
              v-model="search"
            />
          </div>

          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </b-container>

      <b-container class="myStyle">
        <b-carousel
          id="carousel-1"
          v-model="slide"
          :interval="4000"
          controls
          fade="true"
          indicators
          background="transparent"
          img-width="1024"
          img-height="480"
          style="text-shadow: 1px 1px 2px #333;"
          @sliding-start="onSlideStart"
          @sliding-end="onSlideEnd"
        >
          <b-carousel-slide v-for="carouselSection in carouselSections">
            <template slot="img">
              <b-card
                v-for="carouselItem in carouselSection"
                v-bind:title="carouselItem.name"
                v-bind:img-src="carouselItem.img"
                img-alt="Image"
                img-height="150px"
                img-top
                style="width: 30%; display: inline-block;"
                class="m-2"
              >
                <b-card-text>
                  {{ carouselItem.description }}
                </b-card-text>
                <b-button href="#" variant="success">Restaurant page</b-button>
              </b-card>
            </template>
          </b-carousel-slide>
        </b-carousel>
      </b-container>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.15/lodash.min.js"></script>
    <!-- Load polyfills to support older browsers -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es2015%2CIntersectionObserver"></script>

    <!-- Required scripts -->
    <script src="https://unpkg.com/vue@latest/dist/vue.js"></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>

    <script>
      const data = [
        {
          name: 'Restaurant Title1',
          img:
            'https://lh3.googleusercontent.com/VPWlDzu1I_v36IBv7d_dx4z5tnQZVHwCM5ZNOqriAGx13ZZlz0zTK7tMmgzLxjkPizewSA_mYUy8qcN8sg=w1080-h608-p-no-v0',
          description: 'Restaurant description',
        },
        {
          name: 'Restaurant Title2',
          img:
            'https://lh3.googleusercontent.com/VPWlDzu1I_v36IBv7d_dx4z5tnQZVHwCM5ZNOqriAGx13ZZlz0zTK7tMmgzLxjkPizewSA_mYUy8qcN8sg=w1080-h608-p-no-v0',
          description: 'Restaurant description',
        },
        {
          name: 'Restaurant Title3',
          img:
            'https://imgcomfort.com/Userfiles/Upload/images/illustration-geiranger.jpg',
          description: 'Restaurant description',
        },
        {
          name: 'Restaurant Title4',
          img:
            'https://lh3.googleusercontent.com/VPWlDzu1I_v36IBv7d_dx4z5tnQZVHwCM5ZNOqriAGx13ZZlz0zTK7tMmgzLxjkPizewSA_mYUy8qcN8sg=w1080-h608-p-no-v0',
          description: 'Restaurant description',
        },
        {
          name: 'Restaurant Title5',
          img:
            'https://lh3.googleusercontent.com/VPWlDzu1I_v36IBv7d_dx4z5tnQZVHwCM5ZNOqriAGx13ZZlz0zTK7tMmgzLxjkPizewSA_mYUy8qcN8sg=w1080-h608-p-no-v0',
          description: 'Restaurant description',
        },
        {
          name: 'Restaurant Title6',
          img:
            'https://lh3.googleusercontent.com/VPWlDzu1I_v36IBv7d_dx4z5tnQZVHwCM5ZNOqriAGx13ZZlz0zTK7tMmgzLxjkPizewSA_mYUy8qcN8sg=w1080-h608-p-no-v0',
          description: 'Restaurant description',
        },
      ];
      window.app = new Vue({
        el: '#app',
        data: {
          rawData: data,
          search: '',
        },
        computed: {
          carouselSections: function () {
            return _.chunk(this.rawData, 3);
          },
        },
        methods: {
          async submitForm(e) {
            e.preventDefault();
            try {
              const recommendationsArray = await this.getRecommedations(
                this.search
              );
              this.rawData = recommendationsArray;
            } catch (e) {
              console.log(e);
            }
          },
          getRecommedations(userId) {
            return fetch(
              `http://localhost:5000/recommendations/restaurant/${userId}`
            ).then((res) => res.json());
          },
        },
      });
    </script>

    <style>
      .myStyle {
        width: 50%;
      }
    </style>
  </body>
</html>
